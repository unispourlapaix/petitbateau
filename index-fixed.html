<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>La Qu√™te de V√©rit√© - RPG Spirituel</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; touch-action: none; }
        body { 
            font-family: 'Segoe UI', sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            min-height: 100vh; color: white; padding: 8px; overflow: hidden;
        }
        .rpg-title { 
            font-size: clamp(22px, 5.5vw, 32px); margin-bottom: 8px; font-weight: 900;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3); text-align: center;
            background: linear-gradient(45deg, #ffd700, #ffed4e, #f39c12);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            background-clip: text; animation: titlePulse 3s ease-in-out infinite;
        }
        @keyframes titlePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .story { 
            font-size: clamp(11px, 2.8vw, 15px); color: rgba(255,255,255,0.9);
            margin-bottom: 12px; text-align: center; font-style: italic;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3); max-width: 90vw; line-height: 1.3;
        }
        #canvas { 
            border: 4px solid rgba(255,255,255,0.3); border-radius: 25px;
            background: linear-gradient(180deg, #87CEEB 0%, #E0F6FF 30%, #ffffff 100%);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2); max-width: 95vw; max-height: 82vh;
            cursor: pointer; transition: transform 0.2s ease;
        }
        #canvas:hover { transform: scale(1.02); }
        .rpg-info { 
            margin-top: 10px; font-size: clamp(9px, 2.2vw, 13px); 
            color: rgba(255,255,255,0.8); text-align: center;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        .quest-msg { 
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #ffffff, #f8f9fa); 
            padding: 25px 35px; border-radius: 25px; text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3); z-index: 100; display: none;
            font-size: clamp(13px, 3.5vw, 18px); color: #2c3e50; max-width: 88vw; 
            line-height: 1.5; border: 3px solid #f39c12;
            animation: messageSlide 0.3s ease-out;
        }
        @keyframes messageSlide {
            from { opacity: 0; transform: translate(-50%, -60%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }
        .loading-screen {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 1000; transition: opacity 0.5s ease-out;
        }
        .loading-screen.hidden { opacity: 0; pointer-events: none; }
        .spinner {
            width: 50px; height: 50px; border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid #ffd700; border-radius: 50%;
            animation: spin 1s linear infinite; margin-bottom: 20px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .loading-text { color: white; font-size: 18px; text-align: center; margin-bottom: 10px; }
        .loading-subtext { color: rgba(255,255,255,0.7); font-size: 14px; text-align: center; }
        .error-screen {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #e74c3c, #c0392b); color: white;
            padding: 30px; border-radius: 15px; text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5); z-index: 2000; display: none;
            max-width: 90vw;
        }
        .error-screen button {
            background: white; color: #e74c3c; border: none; padding: 10px 20px;
            border-radius: 8px; margin-top: 15px; cursor: pointer; font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="loadingScreen" class="loading-screen">
        <div class="spinner"></div>
        <div class="loading-text">‚öîÔ∏è Chargement de la Qu√™te de V√©rit√© ‚öîÔ∏è</div>
        <div class="loading-subtext">Initialisation des modules RPG...</div>
    </div>

    <div id="errorScreen" class="error-screen">
        <h2>‚ö†Ô∏è Erreur de Chargement</h2>
        <p id="errorMessage">Une erreur est survenue...</p>
        <button onclick="location.reload()">Recharger</button>
    </div>

    <div class="rpg-title">‚öîÔ∏è‚ú® LA QU√äTE DE V√âRIT√â ‚ú®‚öîÔ∏è</div>
    <div class="story">"Un ange gardien transcende les fronti√®res int√©rieures pour r√©v√©ler la V√©rit√©"</div>
    <canvas id="canvas"></canvas>
    <div class="rpg-info">üòá Guide ton Ange dans le Royaume des Fronti√®res Int√©rieures</div>
    <div id="questMsg" class="quest-msg"></div>

    <script type="module">
        const loadingScreen = document.getElementById('loadingScreen');
        const errorScreen = document.getElementById('errorScreen');
        const errorMessage = document.getElementById('errorMessage');

        function showError(message) {
            loadingScreen.style.display = 'none';
            errorMessage.textContent = message;
            errorScreen.style.display = 'block';
            console.error('‚ùå Erreur:', message);
        }

        function hideLoading() {
            loadingScreen.classList.add('hidden');
            setTimeout(() => loadingScreen.style.display = 'none', 500);
        }

        try {
            console.log('üöÄ D√©marrage du jeu...');
            
            // V√©rifier le canvas
            const canvas = document.getElementById('canvas');
            if (!canvas) {
                throw new Error('Canvas element not found');
            }

            // Chargement du module principal avec timeout
            const loadTimeout = setTimeout(() => {
                showError('Timeout: Le chargement prend trop de temps');
            }, 10000);

            import('./js/main.js')
                .then(() => {
                    clearTimeout(loadTimeout);
                    console.log('‚úÖ Modules charg√©s avec succ√®s');
                    
                    // Attendre un peu avant de cacher le loading
                    setTimeout(hideLoading, 1500);
                })
                .catch(error => {
                    clearTimeout(loadTimeout);
                    console.error('‚ùå Erreur lors du chargement:', error);
                    showError(`Erreur de module: ${error.message}`);
                });

        } catch (error) {
            console.error('‚ùå Erreur critique:', error);
            showError(`Erreur critique: ${error.message}`);
        }

        // Gestion des erreurs globales
        window.addEventListener('error', (event) => {
            console.error('‚ùå Erreur JavaScript:', event.error);
            if (!errorScreen.style.display || errorScreen.style.display === 'none') {
                showError(`Erreur JavaScript: ${event.error.message}`);
            }
        });

        window.addEventListener('unhandledrejection', (event) => {
            console.error('‚ùå Promesse rejet√©e:', event.reason);
            if (!errorScreen.style.display || errorScreen.style.display === 'none') {
                showError(`Promesse rejet√©e: ${event.reason}`);
            }
        });
    </script>
</body>
</html>